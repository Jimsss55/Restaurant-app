<div class="mx-auto w-full flex">
  <div class="mx-auto">

    <div>
      <%= render 'layouts/navigation' %>
    </div>

    <h1 class="flex justify-center font-bold text-2xl">Customers</h1>


    <% if @customers.any? %>
      <table class="mt-3 table-auto px-5 bg-white border border-gray-300">
        <thead class="bg-pink-500 text-white">
        <tr>
          <th>Customer Name</th>
          <th>Customer Table Number</th>
          <th>Status</th>
          <th>Total Payment</th>
          <th>Action</th>
        </tr>
        </thead>

        <tbody>
        <% @customers.each do |customer| %>
         <% total=customer.order_items.includes(:menu_item).sum("menu_item_price * quantity") %>
          <tr>
            <td class="border border-gray-300 px-4 py-2"><%= customer.customer_name %></td>
            <td class="border border-gray-300 px-4 py-2"><%= customer.customer_table_id %></td>
            <td class="border border-gray-300 px-4 py-2 <%= customer.payment_status == 'Payment Done' ? 'text-green-500' : 'text-red-500' %>">
              <%= customer.payment_status || "Payment Pending" %>
            </td>
            <td class="border border-gray-300 px-4 py-2"><strong>Nu.<%= total %></strong></td>
            <td class="border border-gray-300 px-4 py-2"><%= link_to "Show this Customer",customer,
                                                                     class: "mt-1 ml-1 rounded-lg py-3 px-5 bg-gray-200
                                                                     hover:bg-gray-100 inline-block font-medium" %>
            </td>
          </tr>
        <% end %>
        </tbody>
      </table>
    <%end %>

    <div class="flex justify-center">
      <%= link_to "Add Customer", new_customer_path,
                  class: "mt-2 ml-2 rounded-lg py-3 px-5 bg-green-300 hover:bg-green-200 inline-block font-medium" %>
    </div>

  </div>
</div>